# miniServiceFrame
最小微服务框架，大二下学期《面向对象高级编程专题》大作业第一版开发计划


# Java 微服务架构服务器（Oat++ 服务外壳）基础版项目设计文档

---

## 一、项目基础架构图

```lua
+----------------------+        +---------------------+        +------------------------+
|                      |        |                     |        |                        |
|  Spring Cloud Gateway| <----> |  Nacos 注册中心     | <----> |  Oat++ 业务服务（C++） |
|  （API 网关）         |        |  （服务注册与配置）   |        |  （C++开发，已有服务）  |
|                      |        |                     |        |                        |
+----------------------+        +---------------------+        +------------------------+
         |
         |
         v
+----------------------+
|  客户端（Postman、浏览器） |
+----------------------+
```

---

## 二、模块拆分与开发流程

| 模块               | 是否必做 | 作用                           | 技术选型             |
|------------------|--------|------------------------------|-------------------|
| 服务注册与发现         | 必做     | 管理服务实例，支持动态发现 Oat++ 服务    | Nacos             |
| API 网关            | 必做     | 统一入口，路由转发 HTTP 请求            | Spring Cloud Gateway |
| 配置中心             | 必做     | 集中管理配置，支持动态读取              | Nacos Config      |
| 服务间通信代理         | 必做     | 简化 HTTP 调用，统一访问 Oat++ 服务       | WebClient / Feign |
| 健康检查（基础存活检测） | ✅建议做 | 注册中心必须的最基础存活检测，非拓展级功能    | Spring Boot Actuator |

> 💡 **说明：**
> 
> - 健康检查是否必须？  
> 👉 **最基础级别：必须有“存活检测”，否则 Nacos 无法正确剔除服务实例。**  
> 👉 你只需要提供 `/actuator/health`，高级健康检查（数据库、自定义检测）可以不做。

---

## 三、详细开发流程

### 1. 服务注册与发现
#### 功能目标：
- Oat++ 服务在启动时向 Nacos 注册
- Java 网关通过 Nacos 动态发现 Oat++ 服务地址

#### 开发流程：
- 本地搭建 Nacos，配置 namespace 和 service name
- Oat++ 服务写入启动时注册逻辑（或直接静态注册在 Nacos 上）
- Java 网关配置 Nacos 服务发现地址

---

### 2. API 网关
#### 功能目标：
- 所有客户端请求统一走网关
- 网关将请求转发到对应的 Oat++ 服务

#### 开发流程：
- 创建 Spring Cloud Gateway 项目
- 配置 Nacos 动态路由（路径 -> 服务名）
- 支持简单路径重写（如果需要）

---

### 3. 配置中心
#### 功能目标：
- Java 微服务读取 Nacos 上的动态配置
- 支持网关路由、服务地址、参数热更新

#### 开发流程：
- Nacos 配置文件管理
- Java 网关配置 Nacos Config
- 配置监听器：支持动态读取配置参数

---

### 4. 服务间通信代理
#### 功能目标：
- 封装调用 Oat++ 服务的 HTTP 客户端
- 使用 WebClient / OpenFeign 实现负载均衡调用

#### 开发流程：
- 创建服务访问接口
- 使用 WebClient 调用 Nacos 注册的 Oat++ 服务
- 可使用泛型封装统一返回格式

---

### 5. 健康检查
#### 功能目标：
- 向注册中心暴露服务健康接口 `/actuator/health`
- Nacos 用于剔除无响应实例

#### 开发流程：
- 添加 Spring Boot Actuator 依赖
- 配置基础健康检查接口暴露
- 集成 Nacos 的服务心跳检测

---

## 四、设计模式与编程技术应用位置
| 技术/模式 | 应用位置                               |
|-----------|----------------------------------|
| 泛型       | 服务调用结果的统一封装                         |
| 枚举       | 定义服务状态（UP、DOWN）或环境类型（DEV、PROD）      |
| 注解       | 自定义服务调用标记（可选，基础版可不复杂）               |
| Lambda/Stream | 过滤服务列表、处理动态配置、路由加载                 |
| 单例模式     | Nacos 客户端、配置管理器                           |
| 静态工厂模式   | 服务代理创建、WebClient 实例化                     |

---

## 五、最小可交付成果总结
| 功能                  | 是否包含 |
|--------------------|--------|
| 服务注册与发现            | ✅ 包含 |
| API 网关               | ✅ 包含 |
| 配置中心                | ✅ 包含 |
| 服务通信封装              | ✅ 包含 |
| 健康检查（基础存活检查）     | ✅ 包含 |
| JWT、限流、熔断、监控、链路追踪 | ❌ 不包含 |
